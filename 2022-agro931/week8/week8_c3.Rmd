---
title: "Ch7. Dominance and Interaction"
author: "Jinliang Yang"
date: "Nov. 1st, 2019"
output:
  xaringan::moon_reader:
    css: ["default", "../../asset/unl-150.css"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```




# Dominance deviation (D)


| Genotype  |  Value as deviated from $M$      | Breeding Value  | Dominance Deviation  | 
| :-------: | :-------: | :-----------: | :-----------: | :-------: | :-------: | 
| $A_1A_1$  |   $2q(\alpha - qd)$   | $2q\alpha$    |   $-2q^2d$   |  
| $A_1A_2$  |   $(q-p)\alpha + 2pqd$  | $(q-p)\alpha$ |    $2pqd$   |  
| $A_2A_2$  |   $-2p(\alpha + pd)$  | $-2p\alpha$   |  $-2p^2d$   |   

- The mean of the BV is **zero**
- It follows that the mean dominance deviation is **zero**.


The mean dominance deviation:

\begin{align*}
 = & p^2 \times (-2q^2d) + 2pq \times 2pqd + q^2 \times (-2p^2d) \\
 = & - 2p^2q^2d + 4p^2q^2d - 2p^2q^2d \\
 = & 0
\end{align*}



---
# A Linear Regression Perspective

### G = A + D

- **A** repsents the breeding value (i.e., A = $\alpha_i + \alpha_j$)
- **D** represents the dominance deviation

--

Further breakdown $A$:

\begin{align*}
 G = & \alpha_1N_1 + \alpha_2N_2 + \delta
\end{align*}

where, 
- $\alpha_i$ is the average effect of allele $i$ and $\alpha = \alpha_1 - \alpha_2$
- $N_i$ is the number of allele $i$ carried by the genotype
- $N \in \{0, 1, 2\}$ for a bi-allelic locus and $N_1 + N_2 = 2$ 

--

Therefore,

\begin{align*}
 G = & \alpha_1N_1 + \alpha_2N_2 + \delta =  \alpha_1N_1 + \alpha_2(2 - N_1) + \delta  \\
   = & 2\alpha_2 + (\alpha_1 - \alpha_2)N_1 + \delta \\
   = & (2\alpha_2 + \delta) + \alpha N_1
\end{align*}



---
# Graphical Representation

```{r linear, fig.align='center', out.width='35%'}
a = 1; d = 3/4*a
p = 4/5; q = 1 - p

alpha <- a + d*(q - p)
a1a1 <- 2*alpha*q
a1a2 <- (q-p)*alpha
a2a2 <- -2*p*alpha

plot(c(0, 1, 2), c(-a, d, a), xlab="Genotype",ylab="", cex.lab=1.5, xaxt="n", pch=17, cex=2, col="red"); 
axis(1, at=c(0, 1, 2), labels=c("A2A2", "A1A2", "A1A1")); mtext("Breeding Value", side = 4, line = 1, cex=1.5, col="blue"); mtext("Genotypic Value", side = 2, line = 2, cex=1.5, col="red")
points(c(0, 1, 2), c(a2a2, a1a2, a1a1), cex=2, col="blue")
lines(c(0, 1, 2), c(a2a2, a1a2, a1a1), lwd=2, col="blue")
```

---

# Graphical Representation

\begin{align*}
G = & (2\alpha_2 + \delta) + \alpha N_1
\end{align*}




.pull-left[
<div align="center">
<img src="Chapter7_c2_files/figure-html/linear-1.png" height=350>
</div>
]


.pull-right[
- The slope is the average effect of allele substitution. As $A_1$ is substituted by $A_2$, the breeding value increaes at a rate equal to $\alpha$.
- Dominance deviation are the differences between the genotypic values and breeding values.
- Dominance can be seen as residuals from the fitted regression line.
]

---
# Interaction deviation (epistasis)

- Epistasis = interaction of alleles at **different** loci
- Also causes deviation of genotypic value from additive genetic value (or BV)

--

Imagine a trait controlled by two loci, A and B. Then

\begin{align*}
 G = & G_A + G_B + I_{AB} \\
   = & (\alpha_i + \alpha_j + \delta_{ij}) + (\alpha_k + \alpha_l + \delta_{kl}) + I_{AB}
\end{align*}

--

Where 

\begin{align*}
 I_{AB} = & \alpha_i\alpha_k + \alpha_i\alpha_l + \alpha_j\alpha_k + \alpha_j\alpha_l \\
    & + \alpha_i\delta_{kl} + \alpha_j\delta_{kl} + \alpha_k\delta_{ij} + \alpha_l\delta_{ij} \\
    & + \delta_{ij}\delta_{kl}
\end{align*}


---
# Interaction deviation (epistasis)

- Interaction effect can arise through interaction between the average allele effects at each locus, between average effect and dominance deviation, and between dominance deviations

- As # of loci increases, so does # of interactions (exponentially)

--

- Summed to contribute to the epistatic deviation ( $I$ )

\begin{align*}
G = \sum_{i=1}^k(A_i + D_i) + I
\end{align*}





